<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Portal - Lowkeycraft</title>
    <link rel="icon" href="logo.png" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <meta name="google-site-verification" content="16MaYtHjuvQX2w8Hocvgembth-ta3El1KVCbawKO13E" />

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6389097554596560"
     crossorigin="anonymous"></script>

</head>

<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <img src="./logo.png" alt="Lowkeycraft Logo">
                    <h1 class="site-title">LOWKEYCRAFT</h1>
                </div>
                <nav>
                    <a href="index.html">Home</a>
                    <a href="discord.html">Discord</a>
                    <a href="stats.html">Stats</a>
                    <a href="staff.html" class="active">Staff</a>
                    <a href="tos.html">Terms</a>
                    <a href="policy.html">Privacy</a>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <section class="hero-section">
            <div class="container">
                <h1 class="hero-title">Staff Portal</h1>
                <p class="hero-subtitle">Authorized Access Only</p>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <div id="loginSection">
                    <div class="feature-card" style="max-width: 500px; margin: 0 auto;">
                        <h2>Staff Login</h2>
                        <p>This portal is restricted to authorized Lowkeycraft staff members only.</p>

                        <form id="passwordForm">
                            <div class="form-group">
                                <label>Enter Staff Password:</label>
                                <input type="password" id="passwordInput" placeholder="Staff password..." required>
                            </div>
                            <button type="submit" id="loginButton" class="btn btn-primary">Access Portal</button>
                        </form>

                        <div id="errorMessage" class="error-message" style="display: none;"></div>
                    </div>
                </div>

                <div id="staffContent" class="animate-fade-in" style="display: none;">
                    <div class="feature-card" style="max-width: 800px; margin: 0 auto;">
                        <h2>Welcome to Staff Portal</h2>
                        <p>You have successfully logged in to the staff portal.</p>

                        <div class="features-grid">
                            <div class="feature-card">
                                <h3>Server Management</h3>
                                <p>Available through game console</p>
                            </div>
                            <div class="feature-card">
                                <h3>Discord Management</h3>
                                <p>Available through Discord admin panel</p>
                            </div>
                            <div class="feature-card">
                                <h3>Support Email</h3>
                                <p><a href="mailto:support@fozmu.studio">support@fozmu.studio</a></p>
                            </div>
                        </div>

                        <h3>Quick Actions</h3>
                        <div class="cta-buttons">
                            <a href="stats.html" class="btn btn-primary">View Player Statistics</a>
                            <a href="discord.html" class="btn btn-secondary">Access Discord</a>
                        </div>

                        <div class="feature-card" style="margin-top: 2rem;">
                            <h3>Staff Guidelines</h3>
                            <p>• Always maintain professional behavior</p>
                            <p>• Respond to player issues promptly</p>
                            <p>• Follow server rules and policies</p>
                            <p>• Report any issues to administration</p>
                        </div>

                        <button onclick="logout()" class="btn btn-secondary" style="margin-top: 2rem;">Logout</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-links">
                    <a href="index.html">Home</a>
                    <a href="discord.html">Discord</a>
                    <a href="stats.html">Stats</a>
                </div>
                <p>© 2025 Fozmu Studios • Staff Portal</p>
            </div>
        </div>
    </footer>

    <script>
        const passwordForm = document.getElementById('passwordForm');
        const passwordInput = document.getElementById('passwordInput');
        const loginButton = document.getElementById('loginButton');
        const errorMessage = document.getElementById('errorMessage');
        const loginSection = document.getElementById('loginSection');
        const staffContent = document.getElementById('staffContent');

        // Check if user is already logged in
        if (sessionStorage.getItem('staffLoggedIn') === 'true') {
            showStaffContent();
        }

        passwordForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const password = passwordInput.value;
            if (!password) return;

            loginButton.disabled = true;
            loginButton.textContent = 'Verifying...';
            errorMessage.style.display = 'none';

            try {
                // For local development, use client-side check
                if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    // Local development fallback
                    const isValid = password === 'MyLowkeyWorld!'; // This matches the .env STAFF_PASSWORD

                    if (isValid) {
                        sessionStorage.setItem('staffLoggedIn', 'true');
                        showStaffContent();
                    } else {
                        showError('Invalid password. Access denied.');
                    }
                } else {
                    // Production: Use Netlify Function
                    const response = await fetch('/api/verify-password', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ password: password })
                    });

                    const result = await response.json();

                    if (result.success) {
                        sessionStorage.setItem('staffLoggedIn', 'true');
                        showStaffContent();
                    } else {
                        showError('Invalid password. Access denied.');
                    }
                }
            } catch (error) {
                console.error('Login error:', error);
                showError('Connection error. Please try again.');
            } finally {
                loginButton.disabled = false;
                loginButton.textContent = 'Access Portal';
                passwordInput.value = '';
            }
        });

        function showStaffContent() {
            loginSection.style.display = 'none';
            staffContent.style.display = 'block';
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
        }

        function logout() {
            sessionStorage.removeItem('staffLoggedIn');
            location.reload();
        }

        passwordInput.focus();
    </script>
</body>
</html>